var Codevanilla_Utile=function(){function toggleIcon(a,t,e){a="object"==typeof a?a:$(a);var r=1===$(a).find("i").length;return null==t&&(t=!1===$(a).hasClass("toggled")),t?r?$(a).addClass("toggled").children("i.fa").removeClass($(a).attr("data-icon-2")).addClass($(a).attr("data-icon-1")):$(a).removeClass("toggled").children("span.glyphicon").removeClass($(a).attr("data-icon-2")).addClass($(a).attr("data-icon-1")):r?$(a).removeClass("toggled").children("i.fa").removeClass($(a).attr("data-icon-1")).addClass($(a).attr("data-icon-2")):$(a).addClass("toggled").children("span.glyphicon").removeClass($(a).attr("data-icon-1")).addClass($(a).attr("data-icon-2")),e&&$(a).html(r?$(a).find("i")[0]:$(a).find("span")[0]).append(e),t}function formatDateAsDaysSince(a,t){if(null===a||""===a)return" - ";var e=new Date(a),r=new Date,o=e.getTime()-r.getTime()<0,n=Math.round(Math.abs((e.getTime()-r.getTime())/6e4)),s=Math.round(Math.abs((e.getTime()-r.getTime())/6e4)),i=Math.round(Math.abs((e.getTime()-r.getTime())/864e5)),d=Math.round(Math.abs((e.getTime()-r.getTime())/6048e5)),l=Math.round(Math.abs((e.getTime()-r.getTime())/314496e5));return n<3?t?addTitleAttr("Just now",a):"Just now":n<60?t?addTitleAttr(n+(o?" Minutes ago":" Minutes left"),a):n+(o?" Minutes ago":" Minutes left"):s<6?t?addTitleAttr(s+(o?" Hours ago":" Hours left"),a):s+(o?" Hours ago":" Hours left"):0===i?t?addTitleAttr("Today",a):"Today":1===i?t?addTitleAttr(o?"Yesterday":"Tomorrow",a):o?"Yesterday":"Tomorrow":i<14?t?addTitleAttr(i+(o?" Days ago":" Days left"),a):i+(o?" Days ago":" Days left"):d>1&&d<52?t?addTitleAttr(d+(o?" Weeks ago":" Weeks left"),a):d+(o?" Weeks ago":" Weeks left"):l>1?t?addTitleAttr(l+(o?" Years ago":" Years left"),a):l+(o?" Years ago":" Years left"):1===l?t?addTitleAttr(l+(o?" Year ago":" Year left"),a):l+(o?" Year ago":" Year left"):a}function addTitleAttr(a,t){return $("<span/>").attr({"data-toggle":"tooltip","data-placement":"auto left",title:t}).text(a)}function nl2br(a){return a.replace(/(?:\r\n|\r|\n)/g,"<br />")}function br2nl(a){return a.replace(/<br\s*[\/]?>/gi,"\n")}function findRowBykey(a,t,e){var r=[];return $.each(a,function(o){a[o][t]===e&&(r=a[o])}),r}function extractValuesByKey(arr,key){var f=[];return $.each(arr,function(index,value){f.push(eval("value."+key))}),f}function buildSelector(a,t,e,r){for(var o=$("<select />").addClass("form-control"),n=0;n<a.length;n++){var s=a[n];$("<option/>").attr("value",r?s[r]:s.id).text(s[t]).appendTo(o)}return void 0!==e?$(o).val(e):o}function buildTable(a,t,e,r,o,n,s){e="object"==typeof e?e:$(e),e.empty();var i=Math.floor(1e4*Math.random()+1)+"_paginationTdId",d=$("<tr/>"),l=$("<tbody/>"),c=$("<tfoot/>"),u=$("<td/>").attr({colspan:a.length,id:i}).appendTo(c);$("<table/>").attr({id:r}).addClass("table table-bordered table-hover dataTable").append($("<thead/>").html(d)).append(l).append(c).appendTo(e);buildTableHeader(a,d,s),buildTableRows(a,t,l),void 0!=o&&void 0!=n&&parseInt(o.offset)+parseInt(o.limit)<parseInt(o.total_rows)&&u.html($("<button/>").text("more...").addClass("btn btn-primary ").click(function(){n(!0)}))}function buildTableHeader(a,t,e){for(var r in a){var o=a[r],n=$("<th/>").html(o.header.title);o.header.sortField&&n.addClass(e).attr({id:"th_"+o.header.title.replace(/ /g,"_"),"tab-index":0,"data-sort-field":o.header.sortField}).append($("<i/>").addClass("fa fa-sort pull-right")).click(function(a){$(this).closest("table").trigger("header_sort",[$(this).attr("data-sort-field"),$(this).attr("id")])}),n.appendTo(t)}}function buildTableRows(a,t,e,r){void 0!==r&&!0!==r||e.empty();for(var o=0;o<t.length;o++){var n=t[o],s=$("<tr/>").data(n).addClass("dataRow").appendTo(e);$.each(a,function(a,t){var e=$("<td/>").appendTo(s);$.each(t.display,function(a,t){t.func&&$(e).append(t.func.apply(this,parseArguments(n,t.args))),t.row&&$(e).append(n[t.row]),t.literal&&$(e).append(t.literal)}),void 0!==t.action&&(Array.isArray(t.action)?$.each(t.action,function(a,t){$(e).on(t.type,function(a){t.func.apply(this,parseArguments($(a.currentTarget).closest(".dataRow").data(),t.args))})}):$(e).on(t.action.type,function(a){t.action.func.apply(this,parseArguments($(a.currentTarget).closest(".dataRow").data(),t.action.args))})),void 0!==t.className&&(t.className.func?e.addClass(t.className.func.apply(this,parseArguments(n,t.className.args))):e.addClass(t.className.literal))})}}function parseArguments(a,t){var e=[];return $.each(t,function(t,r){switch(r.type){case"lookup":e.push(a[r.value]);break;case"row":e.push(a);break;default:e.push(r.value)}}),e}function setTableOrder(a,t,e,r){var o="#"+a;console.log(o),e.controller!==a?($(t).removeClass("active desc asc"),$(t+" i").removeClass("fa-sort-desc fa-sort-asc").addClass("fa-sort"),$(o).addClass("active desc"),$(o).find("i").removeClass("fa-sort").addClass("fa-sort-desc"),e.controller=a,e.field=$(o).attr("data-sort-field"),e.direction="DESC"):"DESC"===e.direction?($(o).removeClass("desc").addClass("asc"),$(o).find("i").removeClass("fa-sort-desc").addClass("fa-sort-asc"),e.direction="ASC"):"ASC"===e.direction&&($(t).removeClass("active desc asc"),$(t+" i").removeClass("fa-sort-desc fa-sort-asc").addClass("fa-sort"),e.field=r.field,e.direction=r.direction,e.controller=null)}function buildPaginationUI(a,t,e){var r=Math.ceil(t.offset/t.limit),o=Math.ceil(t.offset/10)-1;if(r>1)for(var n=$("<span/>").addClass("floatright").appendTo(a),s=1;s<=10;s++){var i=s+10*o;if(i<=r)if(i!==page){var d=$("<button/>").text(i).data({id:i}).addClass("btn ").click(function(a){$("#pageNumber").val($(this).data("id")),e(!0)});$(n).append(d)}else $(n).append($("<span/>").html(i).addClass(" btn thisPage"))}}function doAjax(a,t,e,r,o,n,s,i,d){d=d||!1,"function"!=typeof r&&console.error("You must pass a functionn to doAjax"+r),void 0!==n&&$(n).addClass("active");var l=void 0===s?{}:s,c=void 0===o||"POST"===t?"":"?"+jQuery.param(o);$.ajax({type:t,url:a+e+c,headers:l,data:o,crossDomain:!0,success:function(a){void 0!==n&&$(n).removeClass("active"),i&&(a.passedArgs=i),void 0===a.error?r(a):d?console.log(a):bootbox.alert(a.error)},error:function(a){void 0!==n&&$(n).removeClass("active"),a.responseJSON?d?console.log(a):bootbox.alert(a.responseJSON.error):d?(console.log(a),r({error:"ajax error someting went wrong"})):bootbox.alert(a.responseText)}})}return{doAjax:function(a,t,e,r,o,n,s,i,d){doAjax(a,t,e,r,o,n,s,i,d)},buildSelector:function(a,t,e,r){return buildSelector(a,t,e,r)},buildTable:function(a,t,e,r,o,n,s){buildTable(a,t,e,r,o,n,s)},buildTableRows:function(a,t,e,r){buildTableRows(a,t,e,r)},formatDateAsDaysSince:function(a,t){return formatDateAsDaysSince(a,t)},setTableOrder:function(a,t,e,r){setTableOrder(a,t,e,r)},buildPaginationUI:function(a,t,e){buildPaginationUI(a,t,e)},toggleIcon:function(a,t,e){toggleIcon(a,t,e)},nl2br:function(a){return nl2br(a)},br2nl:function(a){return br2nl(a)},findRowBykey:function(a,t,e){return findRowBykey(a,t,e)},extractValuesByKey:function(a,t){return extractValuesByKey(a,t)},addTitleAttr:function(a,t){return addTitleAttr(a,t)}}};