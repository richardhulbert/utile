var Codevanilla_Utile=function(){function toggleIcon(t,a,e){t="object"==typeof t?t:$(t);var r=1===$(t).find("i").length;return null==a&&(a=$(t).hasClass("toggled")===!1),a?r?$(t).addClass("toggled").children("i.fa").removeClass($(t).attr("data-icon-2")).addClass($(t).attr("data-icon-1")):$(t).removeClass("toggled").children("span.glyphicon").removeClass($(t).attr("data-icon-2")).addClass($(t).attr("data-icon-1")):r?$(t).removeClass("toggled").children("i.fa").removeClass($(t).attr("data-icon-1")).addClass($(t).attr("data-icon-2")):$(t).addClass("toggled").children("span.glyphicon").removeClass($(t).attr("data-icon-1")).addClass($(t).attr("data-icon-2")),e&&$(t).html(r?$(t).find("i")[0]:$(t).find("span")[0]).append(e),a}function formatDateAsDaysSince(t,a){if(null===t||""===t)return" - ";var e=6e4,r=60*e,o=24*r,n=7*o,s=52*n,i=new Date(t),l=new Date,d=i.getTime()-l.getTime()<0,c=Math.round(Math.abs((i.getTime()-l.getTime())/e)),u=Math.round(Math.abs((i.getTime()-l.getTime())/e)),f=Math.round(Math.abs((i.getTime()-l.getTime())/o)),p=Math.round(Math.abs((i.getTime()-l.getTime())/n)),g=Math.round(Math.abs((i.getTime()-l.getTime())/s));return c<3?a?addTitleAttr("Just now",t):"Just now":c<60?a?addTitleAttr(c+(d?" Minutes ago":" Minutes left"),t):c+(d?" Minutes ago":" Minutes left"):u<6?a?addTitleAttr(u+(d?" Hours ago":" Hours left"),t):u+(d?" Hours ago":" Hours left"):0===f?a?addTitleAttr("Today",t):"Today":1===f?a?addTitleAttr(d?"Yesterday":"Tomorrow",t):d?"Yesterday":"Tomorrow":f<14?a?addTitleAttr(f+(d?" Days ago":" Days left"),t):f+(d?" Days ago":" Days left"):p>1&&p<52?a?addTitleAttr(p+(d?" Weeks ago":" Weeks left"),t):p+(d?" Weeks ago":" Weeks left"):g>1?a?addTitleAttr(g+(d?" Years ago":" Years left"),t):g+(d?" Years ago":" Years left"):1===g?a?addTitleAttr(g+(d?" Year ago":" Year left"),t):g+(d?" Year ago":" Year left"):t}function addTitleAttr(t,a){return $("<span/>").attr({"data-toggle":"tooltip","data-placement":"auto left",title:a}).text(t)}function nl2br(t){return t.replace(/(?:\r\n|\r|\n)/g,"<br />")}function br2nl(t){return t.replace(/<br\s*[\/]?>/gi,"\n")}function findRowBykey(t,a,e){var r=[];return $.each(t,function(o){t[o][a]===e&&(r=t[o])}),r}function extractValuesByKey(arr,key){var f=[];return $.each(arr,function(index,value){f.push(eval("value."+key))}),f}function buildSelector(t,a,e,r){for(var o=$("<select />").addClass("form-control"),n=0;n<t.length;n++){var s=t[n];$("<option/>").attr("value",r?s[r]:s.id).text(s[a]).appendTo(o)}return void 0!==e?$(o).val(e):o}function buildTable(t,a,e,r,o,n,s){e="object"==typeof e?e:$(e),e.empty();var i=Math.floor(1e4*Math.random()+1)+"_paginationTdId",l=$("<tr/>"),d=$("<tbody/>"),c=$("<tfoot/>"),u=$("<td/>").attr({colspan:t.length,id:i}).appendTo(c);$("<table/>").attr({id:r}).addClass("table table-bordered table-hover dataTable").append($("<thead/>").html(l)).append(d).append(c).appendTo(e);buildTableHeader(t,l,s),buildTableRows(t,a,d),void 0!=o&&void 0!=n&&parseInt(o.offset)+parseInt(o.limit)<parseInt(o.total_rows)&&u.html($("<button/>").text("more...").addClass("btn btn-primary ").click(function(){n(!0)}))}function buildTableHeader(t,a,e){for(var r in t){var o=t[r],n=$("<th/>").html(o.header.title);o.header.sortField&&n.addClass(e).attr({id:"th_"+o.header.title.replace(/ /g,"_"),"tab-index":0,"data-sort-field":o.header.sortField}).append($("<i/>").addClass("fa fa-sort pull-right")).click(function(t){$(this).closest("table").trigger("header_sort",[$(this).attr("data-sort-field"),$(this).attr("id")])}),n.appendTo(a)}}function buildTableRows(t,a,e,r){void 0!==r&&r!==!0||e.empty();for(var o=0;o<a.length;o++){var n=a[o],s=$("<tr/>").data(n).addClass("dataRow").appendTo(e);$.each(t,function(t,a){var e=$("<td/>").appendTo(s),r="";$.each(a.display,function(t,a){a.func&&$(e).append(a.func.apply(this,parseArguments(n,a.args))),a.row&&$(e).append(n[a.row]),a.literal&&$(e).append(a.literal)}),void 0!==a.action?Array.isArray(a.action)?$.each(a.action,function(t,a){$(e).on(a.type,function(t){a.func.apply(this,parseArguments($(t.currentTarget).closest(".dataRow").data(),a.args))})}):$(e).on(a.action.type,function(t){a.action.func.apply(this,parseArguments($(t.currentTarget).closest(".dataRow").data(),a.action.args))}):""!==r&&e.html(r),void 0!==a.className&&(a.className.func?e.addClass(a.className.func.apply(this,parseArguments(n,a.className.args))):e.addClass(a.className.literal))})}}function parseArguments(t,a){var e=[];return $.each(a,function(a,r){switch(r.type){case"lookup":e.push(t[r.value]);break;case"row":e.push(t);break;default:e.push(r.value)}}),e}function setTableOrder(t,a,e,r){var o="#"+t;console.log(o),e.controller!==t?($(a).removeClass("active desc asc"),$(a+" i").removeClass("fa-sort-desc fa-sort-asc").addClass("fa-sort"),$(o).addClass("active desc"),$(o).find("i").removeClass("fa-sort").addClass("fa-sort-desc"),e.controller=t,e.field=$(o).attr("data-sort-field"),e.direction="DESC"):"DESC"===e.direction?($(o).removeClass("desc").addClass("asc"),$(o).find("i").removeClass("fa-sort-desc").addClass("fa-sort-asc"),e.direction="ASC"):"ASC"===e.direction&&($(a).removeClass("active desc asc"),$(a+" i").removeClass("fa-sort-desc fa-sort-asc").addClass("fa-sort"),e.field=r.field,e.direction=r.direction,e.controller=null)}function buildPaginationUI(t,a,e){$(t).html(parseInt(a.offset)+parseInt(a.limit)<parseInt(a.total_rows)?$("<button/>").text("more...").addClass("btn btn-primary ").click(function(){a.offset=parseInt(a.offset)+parseInt(a.limit),e(!0)}):"")}function doAjax(t,a,e,r,o,n,s){"function"!=typeof r&&console.error("You must pass a functionn to doAjax"+r);var i=void 0===o?"":"?"+jQuery.param(o);void 0!==n&&$(n).addClass("active");var l=void 0===s?{}:s;$.ajax({type:a,url:t+e+i,header:l,success:function(t){void 0!==n&&$(n).removeClass("active"),void 0===t.error?r(t):bootbox.alert(t.error)},error:function(t){void 0!==n&&$(n).removeClass("active"),t.responseJSON?bootbox.alert(t.responseJSON.error):bootbox.alert(t.responseText)}})}return{doAjax:function(t,a,e,r,o,n){doAjax(t,a,e,r,o,n)},buildSelector:function(t,a,e,r){return buildSelector(t,a,e,r)},buildTable:function(t,a,e,r,o,n,s){buildTable(t,a,e,r,o,n,s)},buildTableRows:function(t,a,e,r){buildTableRows(t,a,e,r)},formatDateAsDaysSince:function(t,a){return formatDateAsDaysSince(t,a)},setTableOrder:function(t,a,e,r){setTableOrder(t,a,e,r)},buildPaginationUI:function(t,a,e){buildPaginationUI(t,a,e)},toggleIcon:function(t,a,e){toggleIcon(t,a,e)},nl2br:function(t){return nl2br(t)},br2nl:function(t){return br2nl(t)},findRowBykey:function(t,a,e){return findRowBykey(t,a,e)},extractValuesByKey:function(t,a){return extractValuesByKey(t,a)},addTitleAttr:function(t,a){return addTitleAttr(t,a)}}};