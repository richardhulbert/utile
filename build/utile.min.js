var Codevanilla_Utile=function(){function toggleIcon(t,a,e){t="object"==typeof t?t:$(t);var r=1===$(t).find("i").length;return null==a&&(a=!1===$(t).hasClass("toggled")),a?r?$(t).addClass("toggled").children("i.fa").removeClass($(t).attr("data-icon-2")).addClass($(t).attr("data-icon-1")):$(t).removeClass("toggled").children("span.glyphicon").removeClass($(t).attr("data-icon-2")).addClass($(t).attr("data-icon-1")):r?$(t).removeClass("toggled").children("i.fa").removeClass($(t).attr("data-icon-1")).addClass($(t).attr("data-icon-2")):$(t).addClass("toggled").children("span.glyphicon").removeClass($(t).attr("data-icon-1")).addClass($(t).attr("data-icon-2")),e&&$(t).html(r?$(t).find("i")[0]:$(t).find("span")[0]).append(e),a}function formatDateAsDaysSince(t,a){if(null===t||""===t)return" - ";var e=new Date(t),r=new Date,o=e.getTime()-r.getTime()<0,n=Math.round(Math.abs((e.getTime()-r.getTime())/6e4)),s=Math.round(Math.abs((e.getTime()-r.getTime())/6e4)),i=Math.round(Math.abs((e.getTime()-r.getTime())/864e5)),l=Math.round(Math.abs((e.getTime()-r.getTime())/6048e5)),d=Math.round(Math.abs((e.getTime()-r.getTime())/314496e5));return n<3?a?addTitleAttr("Just now",t):"Just now":n<60?a?addTitleAttr(n+(o?" Minutes ago":" Minutes left"),t):n+(o?" Minutes ago":" Minutes left"):s<6?a?addTitleAttr(s+(o?" Hours ago":" Hours left"),t):s+(o?" Hours ago":" Hours left"):0===i?a?addTitleAttr("Today",t):"Today":1===i?a?addTitleAttr(o?"Yesterday":"Tomorrow",t):o?"Yesterday":"Tomorrow":i<14?a?addTitleAttr(i+(o?" Days ago":" Days left"),t):i+(o?" Days ago":" Days left"):l>1&&l<52?a?addTitleAttr(l+(o?" Weeks ago":" Weeks left"),t):l+(o?" Weeks ago":" Weeks left"):d>1?a?addTitleAttr(d+(o?" Years ago":" Years left"),t):d+(o?" Years ago":" Years left"):1===d?a?addTitleAttr(d+(o?" Year ago":" Year left"),t):d+(o?" Year ago":" Year left"):t}function addTitleAttr(t,a){return $("<span/>").attr({"data-toggle":"tooltip","data-placement":"auto left",title:a}).text(t)}function nl2br(t){return t.replace(/(?:\r\n|\r|\n)/g,"<br />")}function br2nl(t){return t.replace(/<br\s*[\/]?>/gi,"\n")}function findRowBykey(t,a,e){var r=[];return $.each(t,function(o){t[o][a]===e&&(r=t[o])}),r}function extractValuesByKey(arr,key){var f=[];return $.each(arr,function(index,value){f.push(eval("value."+key))}),f}function buildSelector(t,a,e,r){for(var o=$("<select />").addClass("form-control"),n=0;n<t.length;n++){var s=t[n];$("<option/>").attr("value",r?s[r]:s.id).text(s[a]).appendTo(o)}return void 0!==e?$(o).val(e):o}function buildTable(t,a,e,r,o,n,s,i){e="object"==typeof e?e:$(e),e.empty();var l=(Math.floor(1e4*Math.random()+1),$("<tr/>")),d=$("<tbody/>"),c=$("<tfoot/>");$("<table/>").attr({id:r}).addClass("table table-bordered table-hover dataTable").append($("<thead/>").html(l)).append(d).append(c).appendTo(e);if(buildTableHeader(t,l,s),buildTableRows(t,a,d),o&&n&&parseInt(o.limit)<parseInt(o.total_rows)){$("<td/>").attr({colspan:t.length}).appendTo(c).append(pagniationUi(o,n,i))}}function pagniationUi(t,a,e){var e=e||10,r=t.limit,o=Math.ceil(t.total_rows/r),n=Math.ceil(t.offset/r)+1,s=Math.ceil(n/e)-1;if(o>1){for(var i=$("<div/>").addClass(" btn-group pull-right "),l=1;l<=e;l++){var d=l+s*e;if(d<=o)if(d!==n){$("<button/>").text(d).data({currentPage:d}).addClass("btn btn-outline-dark ").click(function(e){t.offset=($(this).data().currentPage-1)*r,a(t)}).appendTo(i)}else i.append($("<span/>").html(d).addClass(" btn btn-dark"))}if(n>1){$("<button/>").addClass("btn btn-outline-dark").text("<").data({currentPage:n}).click(function(e){t.offset=($(this).data().currentPage-1)*r-r,a(t)}).prependTo(i)}if(n<o){$("<button/>").addClass("btn btn-outline-dark").text(">").data({currentPage:n}).click(function(e){t.offset=(n+1)*r-r,a(t)}).appendTo(i)}return i}return""}function buildTableHeader(t,a,e){for(var r in t){var o=t[r],n=$("<th/>").html(o.header.title);o.header.sortField&&n.addClass(e).attr({id:"th_"+o.header.title.replace(/ /g,"_"),"tab-index":0,"data-sort-field":o.header.sortField}).append($("<i/>").addClass("fa fa-sort pull-right")).click(function(t){$(this).closest("table").trigger("header_sort",[$(this).attr("data-sort-field"),$(this).attr("id")])}),n.appendTo(a)}}function buildTableRows(t,a,e,r){void 0!==r&&!0!==r||e.empty();for(var o=0;o<a.length;o++){var n=a[o],s=$("<tr/>").data(n).addClass("dataRow").appendTo(e);$.each(t,function(t,a){var e=$("<td/>").appendTo(s);$.each(a.display,function(t,a){a.func&&$(e).append(a.func.apply(this,parseArguments(n,a.args))),a.row&&$(e).append(n[a.row]),a.literal&&$(e).append(a.literal)}),void 0!==a.action&&(Array.isArray(a.action)?$.each(a.action,function(t,a){$(e).on(a.type,function(t){a.func.apply(this,parseArguments($(t.currentTarget).closest(".dataRow").data(),a.args))})}):$(e).on(a.action.type,function(t){a.action.func.apply(this,parseArguments($(t.currentTarget).closest(".dataRow").data(),a.action.args))})),void 0!==a.className&&(a.className.func?e.addClass(a.className.func.apply(this,parseArguments(n,a.className.args))):e.addClass(a.className.literal))})}}function parseArguments(t,a){var e=[];return $.each(a,function(a,r){switch(r.type){case"lookup":e.push(t[r.value]);break;case"row":e.push(t);break;default:e.push(r.value)}}),e}function setTableOrder(t,a,e,r){var o="#"+t;console.log(o),e.controller!==t?($(a).removeClass("active desc asc"),$(a+" i").removeClass("fa-sort-desc fa-sort-asc").addClass("fa-sort"),$(o).addClass("active desc"),$(o).find("i").removeClass("fa-sort").addClass("fa-sort-desc"),e.controller=t,e.field=$(o).attr("data-sort-field"),e.direction="DESC"):"DESC"===e.direction?($(o).removeClass("desc").addClass("asc"),$(o).find("i").removeClass("fa-sort-desc").addClass("fa-sort-asc"),e.direction="ASC"):"ASC"===e.direction&&($(a).removeClass("active desc asc"),$(a+" i").removeClass("fa-sort-desc fa-sort-asc").addClass("fa-sort"),e.field=r.field,e.direction=r.direction,e.controller=null)}function buildPaginationUI(t,a,e){$(t).html(parseInt(a.offset)+parseInt(a.limit)<parseInt(a.total_rows)?$("<button/>").text("more...").addClass("btn btn-primary ").click(function(){a.offset=parseInt(a.offset)+parseInt(a.limit),e(!0)}):"")}function doAjax(t,a,e,r,o,n,s,i,l){l=l||!1,"function"!=typeof r&&console.error("You must pass a functionn to doAjax"+r),void 0!==n&&$(n).addClass("active");var d=void 0===s?{}:s,c=void 0===o||"POST"===a?"":"?"+jQuery.param(o);$.ajax({type:a,url:t+e+c,headers:d,data:o,crossDomain:!0,success:function(t){void 0!==n&&$(n).removeClass("active"),i&&(t.passedArgs=i),void 0===t.error?r(t):l?console.log(t):bootbox.alert(t.error)},error:function(t){void 0!==n&&$(n).removeClass("active"),t.responseJSON?l?console.log(t):bootbox.alert(t.responseJSON.error):l?(console.log(t),r({error:"ajax error someting went wrong"})):bootbox.alert(t.responseText)}})}return{doAjax:function(t,a,e,r,o,n,s,i,l){doAjax(t,a,e,r,o,n,s,i,l)},buildSelector:function(t,a,e,r){return buildSelector(t,a,e,r)},buildTable:function(t,a,e,r,o,n,s,i){buildTable(t,a,e,r,o,n,s,i)},buildTableRows:function(t,a,e,r){buildTableRows(t,a,e,r)},formatDateAsDaysSince:function(t,a){return formatDateAsDaysSince(t,a)},setTableOrder:function(t,a,e,r){setTableOrder(t,a,e,r)},buildPaginationUI:function(t,a,e){buildPaginationUI(t,a,e)},toggleIcon:function(t,a,e){toggleIcon(t,a,e)},nl2br:function(t){return nl2br(t)},br2nl:function(t){return br2nl(t)},findRowBykey:function(t,a,e){return findRowBykey(t,a,e)},extractValuesByKey:function(t,a){return extractValuesByKey(t,a)},addTitleAttr:function(t,a){return addTitleAttr(t,a)}}};